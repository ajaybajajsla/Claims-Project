<!DOCTYPE html>

<!-- saved from url=(0066)file:///C:/Users/DELL/Downloads/deepseek_html_20250720_c41d5d.html -->
<html lang="en"><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Motor Survey Report - Final</title>
<script src="./Motor Survey Report - Final_files/saved_resource"></script>
<script src="./Motor Survey Report - Final_files/html2docx.js.download"></script>
<style>
    @media print { 
      .no-print { display: none; } 
      body { background-color: white; }
      .page-break { page-break-after: always; }
    }
    input, select, textarea {
      border: 1px solid #ccc;
      border-radius: 4px;
      padding: 6px;
      width: 100%;
    }
    label {
      font-weight: 600;
      display: block;
      margin-bottom: 4px;
    }
    section {
      background-color: #f9f9f9;
      padding: 1rem;
      border-radius: 0.5rem;
      margin-bottom: 1.5rem;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    h2.section-title {
      font-size: 1.25rem;
      font-weight: 700;
      margin-bottom: 1rem;
      color: #1f2937;
    }
    .confidential {
      background-color: #fef2f2;
      border-left: 4px solid #ef4444;
      padding: 0.5rem;
      font-weight: bold;
    }
    .calculation-row {
      background-color: #f0fdf4;
    }
    .total-row {
      background-color: #dcfce7;
      font-weight: bold;
    }
    table {
      width: 100%;
      border-collapse: collapse;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: left;
    }
    th {
      background-color: #f2f2f2;
    }
    .depreciation-applied {
      background-color: #ffebee;
    }
    .depreciation-notice {
      background-color: #fff8e1;
      padding: 0.5rem;
      border-left: 4px solid #ffc107;
    }
    #refGenerator {
      background-color: #f0f9ff;
      padding: 1rem;
      border-radius: 0.5rem;
      margin-bottom: 1rem;
    }
  </style>
<style>*, ::before, ::after{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/* ! tailwindcss v3.4.16 | MIT License | https://tailwindcss.com */*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.col-span-2{grid-column:span 2 / span 2}.mx-auto{margin-left:auto;margin-right:auto}.my-2{margin-top:0.5rem;margin-bottom:0.5rem}.mb-2{margin-bottom:0.5rem}.mb-4{margin-bottom:1rem}.mb-6{margin-bottom:1.5rem}.mb-8{margin-bottom:2rem}.mt-4{margin-top:1rem}.mr-2{margin-right:0.5rem}.mt-16{margin-top:4rem}.mt-2{margin-top:0.5rem}.mt-6{margin-top:1.5rem}.mt-8{margin-top:2rem}.flex{display:flex}.grid{display:grid}.hidden{display:none}.w-full{width:100%}.max-w-7xl{max-width:80rem}.list-disc{list-style-type:disc}.grid-cols-1{grid-template-columns:repeat(1, minmax(0, 1fr))}.items-end{align-items:flex-end}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-2{gap:0.5rem}.gap-4{gap:1rem}.gap-8{gap:2rem}.overflow-x-auto{overflow-x:auto}.rounded{border-radius:0.25rem}.rounded-lg{border-radius:0.5rem}.border-b-2{border-bottom-width:2px}.border-t-2{border-top-width:2px}.border-none{border-style:none}.border-black{--tw-border-opacity:1;border-color:rgb(0 0 0 / var(--tw-border-opacity, 1))}.bg-blue-600{--tw-bg-opacity:1;background-color:rgb(37 99 235 / var(--tw-bg-opacity, 1))}.bg-gray-100{--tw-bg-opacity:1;background-color:rgb(243 244 246 / var(--tw-bg-opacity, 1))}.bg-gray-50{--tw-bg-opacity:1;background-color:rgb(249 250 251 / var(--tw-bg-opacity, 1))}.bg-green-600{--tw-bg-opacity:1;background-color:rgb(22 163 74 / var(--tw-bg-opacity, 1))}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.bg-yellow-600{--tw-bg-opacity:1;background-color:rgb(202 138 4 / var(--tw-bg-opacity, 1))}.bg-gray-600{--tw-bg-opacity:1;background-color:rgb(75 85 99 / var(--tw-bg-opacity, 1))}.bg-purple-600{--tw-bg-opacity:1;background-color:rgb(147 51 234 / var(--tw-bg-opacity, 1))}.bg-red-500{--tw-bg-opacity:1;background-color:rgb(239 68 68 / var(--tw-bg-opacity, 1))}.p-4{padding:1rem}.p-6{padding:1.5rem}.px-4{padding-left:1rem;padding-right:1rem}.py-2{padding-top:0.5rem;padding-bottom:0.5rem}.px-6{padding-left:1.5rem;padding-right:1.5rem}.py-3{padding-top:0.75rem;padding-bottom:0.75rem}.px-2{padding-left:0.5rem;padding-right:0.5rem}.py-1{padding-top:0.25rem;padding-bottom:0.25rem}.pl-5{padding-left:1.25rem}.text-center{text-align:center}.text-right{text-align:right}.text-3xl{font-size:1.875rem;line-height:2.25rem}.text-sm{font-size:0.875rem;line-height:1.25rem}.font-bold{font-weight:700}.italic{font-style:italic}.text-white{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.underline{-webkit-text-decoration-line:underline;text-decoration-line:underline}.shadow{--tw-shadow:0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 1px 3px 0 var(--tw-shadow-color), 0 1px 2px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-lg{--tw-shadow:0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.transition{transition-property:color, background-color, border-color, fill, stroke, opacity, box-shadow, transform, filter, -webkit-text-decoration-color, -webkit-backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter, -webkit-text-decoration-color, -webkit-backdrop-filter;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.hover\:bg-blue-700:hover{--tw-bg-opacity:1;background-color:rgb(29 78 216 / var(--tw-bg-opacity, 1))}.hover\:bg-gray-700:hover{--tw-bg-opacity:1;background-color:rgb(55 65 81 / var(--tw-bg-opacity, 1))}.hover\:bg-green-700:hover{--tw-bg-opacity:1;background-color:rgb(21 128 61 / var(--tw-bg-opacity, 1))}.hover\:bg-purple-700:hover{--tw-bg-opacity:1;background-color:rgb(126 34 206 / var(--tw-bg-opacity, 1))}@media (min-width: 768px){.md\:grid-cols-2{grid-template-columns:repeat(2, minmax(0, 1fr))}.md\:grid-cols-3{grid-template-columns:repeat(3, minmax(0, 1fr))}</style></head>
<body class="bg-gray-100 p-6">


<div id="report"><div class="max-w-7xl mx-auto bg-white p-6 rounded shadow">
<!-- Reference Generator (Hidden after generation) -->
<div class="no-print" id="refGenerator">
<h2 class="section-title">Generate Reference Number</h2>
<div class="grid grid-cols-1 md:grid-cols-3 gap-4">
<div>
<label>Insurer Code</label>
<input id="insurerCode" placeholder="e.g. UIIC" type="text"/>
</div>
<div>
<label>Year</label>
<input id="refYear" type="number" value="2025"/>
</div>
<div>
<label>Month</label>
<select id="refMonth">
<option value="01">January</option>
<option value="02">February</option>
<option value="03">March</option>
<option value="04">April</option>
<option value="05">May</option>
<option value="06">June</option>
<option selected="" value="07">July</option>
<option value="08">August</option>
<option value="09">September</option>
<option value="10">October</option>
<option value="11">November</option>
<option value="12">December</option>
</select>
</div>
<div>
<label>Report Type</label>
<select id="reportType">
<option value="F">Final</option>
<option value="I">Initial</option>
<option value="R">Reinspection</option>
</select>
</div>
<div>
<label>Serial Number</label>
<input id="serialNo" type="number" value="1732"/>
</div>
<div class="flex items-end">
<button class="bg-blue-600 text-white px-4 py-2 rounded" onclick="generateReference()">Generate Reference</button>
</div>
</div>
</div>
<!-- Header -->
<div class="confidential mb-6">
<p class="text-center">PRIVATE AND CONFIDENTIAL</p>
</div>
<h1 class="text-3xl font-bold text-center mb-2">MOTOR (FINAL) SURVEY REPORT</h1>
<div class="flex justify-between mb-8">
<div><strong>Ref:</strong> <span id="refNo">ABAC/1732/2024</span></div>
<div><strong>Date:</strong> <input class="border-none" id="reportDate" type="date"/></div>
</div>
<p class="mb-6 italic">This report is issued by me as a licensed surveyor without prejudice in respect of cause, nature and extent of loss or damage and subject to the terms and conditions of the insurance policy.</p>
<!-- Policy Particulars -->
<section>
<h2 class="section-title">A. POLICY PARTICULARS</h2>
<div class="grid grid-cols-1 md:grid-cols-2 gap-4">
<div><label>1. Insurance Policy No.</label><input id="policyNo" value="2507023124P114617221"/></div>
<div><label>2. Claim No.</label><input id="claimNo" value="2507023125C050031001"/></div>
<div><label>3. Period of Insurance (Own Damage)</label><div class="flex gap-2"><input id="odStart" type="date" value="2024-12-15"/><input id="odEnd" type="date" value="2025-12-14"/></div></div>
<div><label>4. Period of Insurance (TP/Liability)</label><div class="flex gap-2"><input id="tpStart" type="date" value="2023-12-15"/><input id="tpEnd" type="date" value="2026-12-14"/></div></div>
<div>
<label>5. Type of Policy (Own Damage)</label>
<select id="policyType" onchange="toggleDepreciation()">
<option value="Nil depreciation">Nil depreciation</option>
<option value="With depreciation">With depreciation</option>
</select>
</div>
<div><label>6. IDV</label><input id="idv" type="number" value="3668805"/></div>
<div><label>7. Insurer</label><input id="insurer" value="United India Insurance Co. Ltd."/></div>
<div><label>8. Insured</label><input id="insured" value="Mr. DUSHYANT VATS"/></div>
<div><label>9. HPA With</label><input id="hpa"/></div>
</div>
</section>
<!-- Vehicle Particulars -->
<section>
<h2 class="section-title">B. VEHICLE PARTICULARS</h2>
<div class="grid grid-cols-1 md:grid-cols-2 gap-4">
<div><label>1. Registration No.</label><input id="regNo" value="HR 51AF 0001"/></div>
<div><label>2. Registered Owner</label><input id="owner" value="Mr. DUSHYANT VATS"/></div>
<div><label>3. Date of Delivery</label><input id="deliveryDate" type="date"/></div>
<div><label>4. Date of Registration and Valid up to</label><div class="flex gap-2"><input id="regDate" type="date"/><input id="regValidDate" type="date"/></div></div>
<div><label>5. Registration Authority</label><input id="regAuthority"/></div>
<div><label>6. Chassis No.</label><input id="chassisNo" value="MBJAA3GS700600467"/></div>
<div><label>7. Engine No.</label><input id="engineNo" value="1GDA766701"/></div>
<div><label>8. Odometer Reading</label><input id="odometer" value="44908 KM"/></div>
<div><label>9. Make/Model and Year of Manufacture</label><input id="makeModel" value="TOYOTA FORTUNER LEGENDER"/></div>
<div><label>10. Class of Vehicle</label><input id="vehicleClass"/></div>
<div><label>11. Type of Body</label><input id="bodyType"/></div>
<div><label>12. Colour of Vehicle</label><input id="color"/></div>
<div><label>13. Engine Cubic Capacity</label><input id="engineCC"/></div>
<div><label>14. Reg. Laden and Unladen Weight</label><input id="weight"/></div>
<div><label>15. Seating Capacity</label><input id="seatingCapacity"/></div>
<div><label>16. Tax Paid up to</label><input id="taxPaid"/></div>
<div><label>17. Pre Accident Condition</label><input id="preAccident"/></div>
</div>
</section>
<!-- Driver Particulars -->
<section>
<h2 class="section-title">C. DRIVER PARTICULARS</h2>
<div class="grid grid-cols-1 md:grid-cols-2 gap-4">
<div><label>1. Name of Driver</label><input id="driverName"/></div>
<div><label>2. M D L No.</label><input id="licenseNo"/></div>
<div><label>3. Date of Issue &amp; Validity</label><div class="flex gap-2"><input id="licenseIssue" type="date"/><input id="licenseValid" type="date"/></div></div>
<div><label>4. Authorized to Drive</label><input id="authorizedDrive"/></div>
<div><label>5. Issuing Authority</label><input id="licenseAuthority"/></div>
</div>
</section>
<!-- Loss Details -->
<section>
<h2 class="section-title">D. DETAILS OF LOSS AND SURVEY</h2>
<div class="grid grid-cols-1 md:grid-cols-2 gap-4">
<div><label>1. Date and Time of Loss</label><div class="flex gap-2"><input id="lossDate" type="date"/><input id="lossTime" type="time"/></div></div>
<div><label>2. Place of Loss</label><input id="lossPlace"/></div>
<div class="col-span-2"><label>3. Third Party Details, If any</label><input id="thirdParty"/></div>
<div><label>4. Police Report, if any</label><input id="policeReport"/></div>
<div><label>5. Name of Police Station</label><input id="policeStation"/></div>
<div><label>6. Survey Entrusted By</label><input id="surveyBy"/></div>
<div><label>7. Date of Allotment of Survey</label><input id="surveyAllotment" type="date"/></div>
<div><label>8. Date and Time of Survey</label><div class="flex gap-2"><input id="surveyDate" type="date" value="2025-07-01"/><input id="surveyTime" type="time" value="17:00"/></div></div>
<div class="col-span-2"><label>9. Place of Survey</label><input id="surveyPlace" value="M/s GALAXY TOYOTA, OKHLA PHASE-I"/></div>
</div>
</section>
<!-- Cause and Nature of Loss -->
<section>
<h2 class="section-title">E. CAUSE AND NATURE OF LOSS</h2>
<textarea class="w-full" id="lossCause" rows="4">The cause of loss as per the claim form appears to be genuine and the damage sustained by the vehicle are compatible with the said incident.</textarea>
</section>
<!-- Nature and Extent of Loss -->
<section>
<h2 class="section-title">F. NATURE AND EXTENT OF LOSS</h2>
<textarea class="w-full" id="lossExtent" rows="4">Under instructions from M/s. United India Insurance Co. Ltd. CLAIM HUB, RO 1. I, the undersigned inspected the vehicle from the premises of M/s. M/s GALAXY TOYOTA, OKHLA PHASE-I. On a thorough examination and discussion with the repairer the loss has been recorded in loss assessment sheet.</textarea>
</section>
<!-- Parts Assessment with Depreciation -->
<section class="page-break">
<h2 class="section-title">H. LOSS ASSESSMENT - PARTS ASSESSMENT</h2>
<div class="depreciation-notice mb-4" id="depreciationNotice">
<strong>Note:</strong> Depreciation is currently NOT applied (Policy Type: Nil depreciation)
      </div>
<button class="mb-4 bg-green-600 text-white px-4 py-2 rounded no-print" id="addPartsRow">Add Part</button>
<div class="overflow-x-auto">
<table class="w-full">
<thead>
<tr>
<th>S/N</th>
<th>Description</th>
<th>Part Type</th>
<th>Qty</th>
<th>Unit Price</th>
<th>GST %</th>
<th>Dep %</th>
<th>Dep Amt</th>
<th>After Dep</th>
<th>GST Amt</th>
<th>Total Amt</th>
<th class="no-print"></th>
</tr>
</thead>
<tbody id="partsTableBody">
<!-- Rows will be added here -->
<tr>
<td>1</td>
<td><input class="part-desc w-full" type="text" value="Front Bumper"/></td>
<td>
<select class="part-type w-full" onchange="calculatePartRow(this)">
<option value="metallic">Metallic</option>
<option selected="" value="plastic">Plastic/Rubber/Nylon</option>
<option value="glass">Glass/Fibre</option>
<option value="battery">Battery</option>
<option value="tyre">Tyre/Tube</option>
</select>
</td>
<td><input class="part-qty w-full" onchange="calculatePartRow(this)" type="number" value="1"/></td>
<td><input class="part-amount w-full" onchange="calculatePartRow(this)" type="number" value="15000"/></td>
<td>
<select class="part-gst w-full" onchange="calculatePartRow(this)">
<option value="0">0%</option>
<option value="5">5%</option>
<option value="12">12%</option>
<option value="18">18%</option>
<option selected="" value="28">28%</option>
</select>
</td>
<td class="part-dep-rate">0%</td>
<td class="part-dep-amt">0.00</td>
<td class="part-after-dep">15000.00</td>
<td class="part-gst-amt">4200.00</td>
<td class="part-total">19200.00</td>
<td class="no-print"><button class="bg-red-500 text-white px-2 py-1 rounded" onclick="deleteRow(this)">Delete</button></td>
</tr><tr>
<td>2</td>
<td><input class="part-desc w-full" type="text" value="Headlight Assembly"/></td>
<td>
<select class="part-type w-full" onchange="calculatePartRow(this)">
<option value="metallic">Metallic</option>
<option value="plastic">Plastic/Rubber/Nylon</option>
<option selected="" value="glass">Glass/Fibre</option>
<option value="battery">Battery</option>
<option value="tyre">Tyre/Tube</option>
</select>
</td>
<td><input class="part-qty w-full" onchange="calculatePartRow(this)" type="number" value="1"/></td>
<td><input class="part-amount w-full" onchange="calculatePartRow(this)" type="number" value="12000"/></td>
<td>
<select class="part-gst w-full" onchange="calculatePartRow(this)">
<option value="0">0%</option>
<option value="5">5%</option>
<option value="12">12%</option>
<option value="18">18%</option>
<option selected="" value="28">28%</option>
</select>
</td>
<td class="part-dep-rate">0%</td>
<td class="part-dep-amt">0.00</td>
<td class="part-after-dep">12000.00</td>
<td class="part-gst-amt">3360.00</td>
<td class="part-total">15360.00</td>
<td class="no-print"><button class="bg-red-500 text-white px-2 py-1 rounded" onclick="deleteRow(this)">Delete</button></td>
</tr><tr>
<td>3</td>
<td><input class="part-desc w-full" type="text" value="Radiator Grill"/></td>
<td>
<select class="part-type w-full" onchange="calculatePartRow(this)">
<option selected="" value="metallic">Metallic</option>
<option value="plastic">Plastic/Rubber/Nylon</option>
<option value="glass">Glass/Fibre</option>
<option value="battery">Battery</option>
<option value="tyre">Tyre/Tube</option>
</select>
</td>
<td><input class="part-qty w-full" onchange="calculatePartRow(this)" type="number" value="1"/></td>
<td><input class="part-amount w-full" onchange="calculatePartRow(this)" type="number" value="8000"/></td>
<td>
<select class="part-gst w-full" onchange="calculatePartRow(this)">
<option value="0">0%</option>
<option value="5">5%</option>
<option value="12">12%</option>
<option value="18">18%</option>
<option selected="" value="28">28%</option>
</select>
</td>
<td class="part-dep-rate">0%</td>
<td class="part-dep-amt">0.00</td>
<td class="part-after-dep">8000.00</td>
<td class="part-gst-amt">2240.00</td>
<td class="part-total">10240.00</td>
<td class="no-print"><button class="bg-red-500 text-white px-2 py-1 rounded" onclick="deleteRow(this)">Delete</button></td>
</tr></tbody>
<tfoot>
<tr class="total-row">
<td colspan="4">Total</td>
<td id="partsSubtotal">35000.00</td>
<td></td>
<td></td>
<td id="partsDepTotal">0.00</td>
<td id="partsAfterDep">35000.00</td>
<td id="partsGstTotal">9800.00</td>
<td id="partsGrandTotal">44800.00</td>
</tr>
</tfoot>
</table>
</div>
<!-- Depreciation Calculation as per IRDA -->
<div class="mt-4 p-4 bg-gray-50 rounded" id="depreciationCalculation">
<h3 class="font-bold mb-2">Depreciation Calculation as per IRDA Guidelines</h3>
<div class="grid grid-cols-1 md:grid-cols-3 gap-4">
<div>
<label>Age of Vehicle (Years)</label>
<input class="w-full" id="vehicleAge" max="15" min="0" onchange="calculateAllParts()" type="number" value="1"/>
</div>
<div class="col-span-2">
<p class="text-sm"><strong>Standard Depreciation Rates:</strong></p>
<ul class="text-sm list-disc pl-5">
<li><strong>Rubber/Nylon/Plastic Parts:</strong> 50%</li>
<li><strong>Glass/Fibre Parts:</strong> 30%</li>
<li><strong>Metallic Parts:</strong> Based on vehicle age (see table below)</li>
<li><strong>Batteries/Tyres/Tubes:</strong> 50%</li>
</ul>
</div>
</div>
<div class="mt-4 overflow-x-auto">
<table class="w-full text-sm">
<thead>
<tr>
<th>Vehicle Age</th>
<th>Depreciation Rate</th>
<th>Vehicle Age</th>
<th>Depreciation Rate</th>
</tr>
</thead>
<tbody>
<tr>
<td>Not exceeding 6 months</td>
<td>0%</td>
<td>4 years</td>
<td>40%</td>
</tr>
<tr>
<td>6 months to 1 year</td>
<td>5%</td>
<td>5 years</td>
<td>45%</td>
</tr>
<tr>
<td>1-2 years</td>
<td>10%</td>
<td>6 years</td>
<td>50%</td>
</tr>
<tr>
<td>2-3 years</td>
<td>15%</td>
<td>7 years</td>
<td>55%</td>
</tr>
<tr>
<td>3-4 years</td>
<td>25%</td>
<td>8 years &amp; above</td>
<td>60%</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<!-- Labour Assessment -->
<section>
<h2 class="section-title">LABOUR ASSESSMENT</h2>
<button class="mb-4 bg-yellow-600 text-white px-4 py-2 rounded no-print" id="addLabourRow">Add Labour</button>
<div class="overflow-x-auto">
<table class="w-full">
<thead>
<tr>
<th>S/N</th>
<th>Description</th>
<th>Est Amount</th>
<th>Allowed R&amp;R</th>
<th>Allowed Painting</th>
<th>GST %</th>
<th>GST Amt</th>
<th>Total Amt</th>
<th class="no-print"></th>
</tr>
</thead>
<tbody id="labourTableBody">
<!-- Rows will be added here -->
<tr>
<td>1</td>
<td><input class="labour-desc w-full" type="text" value="Front body repair"/></td>
<td><input class="labour-est w-full" onchange="calculateLabourRow(this)" type="number" value="5000"/></td>
<td><input class="labour-rr w-full" onchange="calculateLabourRow(this)" type="number" value="4000"/></td>
<td><input class="labour-paint w-full" onchange="calculateLabourRow(this)" type="number" value="1000"/></td>
<td>
<select class="labour-gst w-full" onchange="calculateLabourRow(this)">
<option value="0">0%</option>
<option selected="" value="18">18%</option>
</select>
</td>
<td class="labour-gst-amt">1620.00</td>
<td class="labour-total">10620.00</td>
<td class="no-print"><button class="bg-red-500 text-white px-2 py-1 rounded" onclick="deleteRow(this)">Delete</button></td>
</tr><tr>
<td>2</td>
<td><input class="labour-desc w-full" type="text" value="Bumper replacement"/></td>
<td><input class="labour-est w-full" onchange="calculateLabourRow(this)" type="number" value="2000"/></td>
<td><input class="labour-rr w-full" onchange="calculateLabourRow(this)" type="number" value="1500"/></td>
<td><input class="labour-paint w-full" onchange="calculateLabourRow(this)" type="number" value="500"/></td>
<td>
<select class="labour-gst w-full" onchange="calculateLabourRow(this)">
<option value="0">0%</option>
<option selected="" value="18">18%</option>
</select>
</td>
<td class="labour-gst-amt">720.00</td>
<td class="labour-total">4720.00</td>
<td class="no-print"><button class="bg-red-500 text-white px-2 py-1 rounded" onclick="deleteRow(this)">Delete</button></td>
</tr></tbody>
<tfoot>
<tr class="total-row">
<td colspan="2">Total</td>
<td id="labourEstTotal">7000.00</td>
<td id="labourRrTotal">5500.00</td>
<td id="labourPaintTotal">7500.00</td>
<td></td>
<td id="labourGstTotal">2340.00</td>
<td id="labourGrandTotal">15340.00</td>
</tr>
<tr class="depreciation-applied">
<td colspan="6">Less: Depreciation on Painting (12.5%)</td>
<td id="paintDepAmt">937.50</td>
<td id="labourAfterDep">14402.50</td>
</tr>
</tfoot>
</table>
</div>
</section>
<!-- Summary of Assessment -->
<section class="page-break">
<h2 class="section-title">I. SUMMARY OF ASSESSMENT</h2>
<div class="overflow-x-auto">
<table class="w-full">
<thead>
<tr>
<th>Description</th>
<th>Estimate (Rs.)</th>
<th>Assessed For (Rs.)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Total Parts Amount (Before Dep)</td>
<td><input class="border-none text-right" id="partsEstimate" readonly="" type="number"/></td>
<td id="partsAssessed">35000.00</td>
</tr>
<tr class="hidden" id="depreciationRow">
<td>Less: Depreciation on Parts</td>
<td><input class="border-none text-right" id="depreciationEstimate" readonly="" type="number"/></td>
<td id="depreciationAssessed">0.00</td>
</tr>
<tr>
<td>Parts After Depreciation</td>
<td><input class="border-none text-right" id="partsAfterDepEstimate" readonly="" type="number"/></td>
<td id="partsAfterDepAssessed">35000.00</td>
</tr>
<tr>
<td>GST on Parts</td>
<td><input class="border-none text-right" id="gstPartsEstimate" readonly="" type="number"/></td>
<td id="gstPartsAssessed">9800.00</td>
</tr>
<tr>
<td>Total Labour Charge (R&amp;R)</td>
<td><input class="border-none text-right" id="labourRrEstimate" readonly="" type="number"/></td>
<td id="labourRrAssessed">5500.00</td>
</tr>
<tr>
<td>Total Labour Charge (Painting)</td>
<td><input class="border-none text-right" id="labourPaintEstimate" readonly="" type="number"/></td>
<td id="labourPaintAssessed">7500.00</td>
</tr>
<tr id="paintDepRow">
<td>Less: Depreciation on Painting (12.5%)</td>
<td><input class="border-none text-right" id="paintDepEstimate" readonly="" type="number"/></td>
<td id="paintDepAssessed">937.50</td>
</tr>
<tr>
<td>GST on Labour</td>
<td><input class="border-none text-right" id="labourGstEstimate" readonly="" type="number"/></td>
<td id="labourGstAssessed">2340.00</td>
</tr>
<tr class="total-row">
<td>Gross Amount</td>
<td id="grossEstimate">59202.50</td>
<td id="grossAssessed">59202.50</td>
</tr>
<tr>
<td>Less Policy Excess</td>
<td><input class="border-none text-right" id="policyExcess" onchange="calculateSummary()" type="number"/></td>
<td id="excessAssessed">0.00</td>
</tr>
<tr>
<td>Less Salvage Value</td>
<td><input class="border-none text-right" id="salvageValue" onchange="calculateSummary()" type="number"/></td>
<td id="salvageAssessed">0.00</td>
</tr>
<tr class="total-row">
<td>Net Assessed Amount</td>
<td id="netEstimate">59202.50</td>
<td id="netAssessed">59202.50</td>
</tr>
<tr class="total-row">
<td>AMOUNT PAYABLE (ROUND OFF TO)</td>
<td id="roundEstimate">59203.00</td>
<td id="roundAssessed">59203.00</td>
</tr>
</tbody>
</table>
</div>
<div class="mt-4 text-center">
<p class="font-bold">The Loss is Assessed for Rs.</p>
<p class="border-t-2 border-b-2 border-black py-2 my-2" id="amountInWords">(Rupees (Rupees fifty nine only) thousand two hundred and three only)</p>
</div>
</section>
<!-- Remarks -->
<section>
<h2 class="section-title">J. REMARKS</h2>
<div class="grid grid-cols-1 gap-2">
<div class="flex">
<div class="font-bold mr-2">1.</div>
<div>The cause of loss as per the claim form appears to be genuine and the damage sustained by the vehicle are compatible with the said incident.</div>
</div>
<div class="flex">
<div class="font-bold mr-2">2.</div>
<div>The DL &amp; RC have been verified Online</div>
</div>
<div class="flex">
<div class="font-bold mr-2">3.</div>
<div>The payment of the claim in favour of Workshop.</div>
</div>
<div class="flex">
<div class="font-bold mr-2">4.</div>
<div>Chassis Number Verified Physically</div>
</div>
<div class="flex">
<div class="font-bold mr-2">5.</div>
<div>There is no FIR in the said Claim</div>
</div>
<div class="flex">
<div class="font-bold mr-2">6.</div>
<div>There is No TP loss reported</div>
</div>
</div>
<div class="mt-4 italic">
        THIS REPORT IS ISSUED WITHOUT PREJUDICE
      </div>
<div class="mt-4 text-right">
<p>for Aay Bee Associates &amp; Consultants</p>
</div>
</section>
<!-- Footer -->
<section class="mt-8">
<div class="grid grid-cols-1 md:grid-cols-2 gap-8">
<div>
<p class="font-bold">To,</p>
<p>United India Insurance Co. Ltd.</p>
<p>Policy No: 2507023124P114617221</p>
<p>Claim No: 2507023125C050031001</p>
<p>GSTIN:</p>
<p>Insured: Mr. DUSHYANT VATS</p>
<p>Vehicle Reg No: HR 51AF 0001</p>
</div>
<div>
<table class="w-full">
<tbody><tr>
<td>Survey Fee (Final)</td>
<td><input class="border-none text-right" id="surveyFee" onchange="calculateFees()" type="number" value="5600.00"/></td>
</tr>
<tr>
<td>Conveyance</td>
<td><input class="border-none text-right" id="conveyance" onchange="calculateFees()" type="number" value="500.00"/></td>
</tr>
<tr>
<td>Photographic Expense</td>
<td><input class="border-none text-right" id="photoExpense" onchange="calculateFees()" type="number" value="300.00"/></td>
</tr>
<tr class="total-row">
<td>Total</td>
<td id="feesTotal">6400.00</td>
</tr>
</tbody></table>
</div>
</div>
<div class="mt-8 overflow-x-auto">
<table class="w-full">
<thead>
<tr>
<th>Description</th>
<th>SAC</th>
<th>Taxable Value</th>
<th colspan="2">CGST</th>
<th colspan="2">SGST</th>
<th colspan="2">IGST</th>
</tr>
<tr>
<th></th>
<th></th>
<th></th>
<th>Rate</th>
<th>Amt</th>
<th>Rate</th>
<th>Amt</th>
<th>Rate</th>
<th>Amt</th>
</tr>
</thead>
<tbody>
<tr>
<td>Gross Professional Fee</td>
<td>997162</td>
<td id="taxableValue">5423.73</td>
<td>9%</td>
<td id="cgstAmount">488.14</td>
<td>9%</td>
<td id="sgstAmount">488.14</td>
<td>0%</td>
<td>0.00</td>
</tr>
</tbody>
<tfoot>
<tr>
<td colspan="8">GST</td>
<td id="totalGst">976.27</td>
</tr>
<tr class="total-row">
<td colspan="8">GRAND TOTAL</td>
<td id="grandTotal">6400.00</td>
</tr>
<tr class="total-row">
<td colspan="8">ROUND OFF TO</td>
<td id="roundTotal">6400.00</td>
</tr>
</tfoot>
</table>
</div>
<div class="mt-8 grid grid-cols-1 md:grid-cols-3 gap-4">
<div>
<p class="font-bold">Surveyor Code: 2664059</p>
</div>
<div>
<p class="font-bold underline">Bank Details</p>
<p>ICICI BANK</p>
<p>A/C NO: 777705032514</p>
<p>IFSC Code: ICIC0000087</p>
<p>PAN: AAEPB7654F</p>
</div>
<div class="text-right">
<p class="mt-16">Signature</p>
</div>
</div>
</section>
<!-- Reinspection Report -->
<section class="page-break mt-8">
<div class="confidential mb-6">
<p class="text-center">PRIVATE AND CONFIDENTIAL</p>
</div>
<h1 class="text-3xl font-bold text-center mb-2">MOTOR (REINSPECTION) SURVEY REPORT</h1>
<div class="flex justify-between mb-8">
<div><strong>Ref:</strong> <span id="reinspectionRef">ABAC/1732/2024</span></div>
<div><strong>Date:</strong> <span id="reinspectionDate">20-07-2025</span></div>
</div>
<p class="mb-6">I inspected the vehicle bearing registration number HR 51AF 0001 on <span id="reinspectionDateText">20-07-2025, 05:00 PM</span> after completion of its repair work at M/s. M/s GALAXY TOYOTA, OKHLA PHASE-I. to verify whether the necessary repair/replacement has been carried out satisfactorily according to the final survey recommendations and my report is as follows.</p>
<h2 class="section-title">A. POLICY PARTICULARS</h2>
<div class="grid grid-cols-1 md:grid-cols-2 gap-4">
<div><label>1. Policy No.</label><input readonly="" value="2507023124P114617221"/></div>
<div><label>2. Claim No.</label><input readonly="" value="2507023125C050031001"/></div>
<div><label>3. Period of Insurance (Own Damage)</label><input readonly="" value="15-12-2024 to 14-12-2025"/></div>
<div><label>4. Period of Insurance (TP/Liability)</label><input readonly="" value="15-12-2023 to 14-12-2026"/></div>
<div><label>5. Type of Policy (Own Damage)</label><input readonly="" value="Nil depreciation"/></div>
<div><label>6. IDV</label><input readonly="" value="Rs. 3668805.00"/></div>
<div><label>7. Insurer</label><input readonly="" value="M/s. United India Insurance Co. Ltd., RADHA CINEMA ROAD, CIVIL LINE, RAMPUR, UP"/></div>
<div><label>8. Insured</label><input readonly="" value="Mr. DUSHYANT VATS"/></div>
</div>
<h2 class="section-title mt-6">B. VEHICLE PARTICULARS</h2>
<div class="grid grid-cols-1 md:grid-cols-2 gap-4">
<div><label>1. Registration No.</label><input readonly="" value="HR 51AF 0001"/></div>
<div><label>2. Registered Owner</label><input readonly="" value="Mr. DUSHYANT VATS"/></div>
<div><label>3. Chassis No.</label><input readonly="" value="MBJAA3GS700600467"/></div>
<div><label>4. Engine No.</label><input readonly="" value="1GDA766701"/></div>
<div><label>5. Odometer Reading</label><input readonly="" value="44908 KM"/></div>
<div><label>6. Make/Model</label><input readonly="" value="TOYOTA FORTUNER LEGENDER"/></div>
</div>
<p class="mt-6">At the time of inspection vehicle was seen completely repaired and in good road worthy condition.</p>
<p class="mt-2">On the detailed inspection all the repair works were found carried out satisfactorily and all the parts recommended for replacement were found replaced with new.</p>
<h2 class="section-title mt-6">Parts Replaced</h2>
<div class="overflow-x-auto">
<table class="w-full">
<thead>
<tr>
<th>S/N</th>
<th>Parts Replaced</th>
<th>QTY</th>
<th>S/N</th>
<th>Parts Replaced</th>
<th>QTY</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>Front Bumper (Plastic)</td>
<td>1</td>
<td>2</td>
<td>Headlight Assembly (Glass)</td>
<td>1</td>
</tr>
<tr>
<td>3</td>
<td>Radiator Grill (Metallic)</td>
<td>1</td>
<td>4</td>
<td>Front Right Fender (Metallic)</td>
<td>1</td>
</tr>
<tr>
<td>5</td>
<td>Front Right Tyre</td>
<td>1</td>
<td>6</td>
<td>Front Right Wheel Rim</td>
<td>1</td>
</tr>
</tbody>
</table>
</div>
<div class="mt-6 italic">
        "ISSUED WITHOUT PREJUDICE"
      </div>
<div class="mt-4 text-right">
<p>for Aay Bee Associates &amp; Consultants</p>
</div>
</section>
<!-- Action Buttons -->
<div class="mt-8 no-print flex justify-center gap-4">
<button class="bg-blue-600 text-white px-6 py-3 rounded-lg shadow-lg hover:bg-blue-700 transition" onclick="window.print()">Print Report</button>
<button class="bg-purple-600 text-white px-6 py-3 rounded-lg shadow-lg hover:bg-purple-700 transition" onclick="exportToWord()">Download as Word</button>
<button class="bg-green-600 text-white px-6 py-3 rounded-lg shadow-lg hover:bg-green-700 transition" onclick="saveReport()">Save Report</button>
<button class="bg-gray-600 text-white px-6 py-3 rounded-lg shadow-lg hover:bg-gray-700 transition" onclick="resetForm()">Reset Form</button>
</div>
</div><script>
    // Initialize the form with sample data
    document.addEventListener("DOMContentLoaded", function() {
      // Set current date as default
      const today = new Date();
      const formattedDate = today.toISOString().split('T')[0];
      document.getElementById("reportDate").value = formattedDate;
      
      // Format date for display
      const day = String(today.getDate()).padStart(2, '0');
      const month = String(today.getMonth() + 1).padStart(2, '0');
      const year = today.getFullYear();
      document.getElementById("reinspectionDate").textContent = `${day}-${month}-${year}`;
      document.getElementById("reinspectionDateText").textContent = `${day}-${month}-${year}, 05:00 PM`;
      
      // Add initial rows to parts and labour tables
      addInitialParts();
      addInitialLabour();
      
      // Calculate all totals
      calculateAllParts();
      calculateAllLabour();
      calculateSummary();
      calculateFees();
    });

    // Generate reference number
    function generateReference() {
      const insurerCode = document.getElementById("insurerCode").value || "ABAC";
      const year = document.getElementById("refYear").value || "2025";
      const month = document.getElementById("refMonth").value || "07";
      const reportType = document.getElementById("reportType").value || "F";
      const serialNo = document.getElementById("serialNo").value || "1732";
      
      const refNo = `${insurerCode}/${serialNo}/${year}`;
      document.getElementById("refNo").textContent = refNo;
      document.getElementById("reinspectionRef").textContent = refNo;
      
      // Hide the reference generator after generation
      document.getElementById("refGenerator").classList.add("hidden");
    }

    // Toggle depreciation fields based on policy type
    function toggleDepreciation() {
      const policyType = document.getElementById("policyType").value;
      const depreciationNotice = document.getElementById("depreciationNotice");
      const depreciationRow = document.getElementById("depreciationRow");
      
      if (policyType === "With depreciation") {
        depreciationNotice.innerHTML = '<strong>Note:</strong> Depreciation is being applied as per IRDA guidelines (Policy Type: With depreciation)';
        depreciationNotice.className = "depreciation-notice mb-4";
        depreciationRow.classList.remove("hidden");
      } else {
        depreciationNotice.innerHTML = '<strong>Note:</strong> Depreciation is currently NOT applied (Policy Type: Nil depreciation)';
        depreciationNotice.className = "depreciation-notice mb-4";
        depreciationRow.classList.add("hidden");
      }
      
      calculateAllParts();
    }

    // Add initial parts rows
    function addInitialParts() {
      const parts = [
        { desc: "Front Bumper", type: "Plastic", qty: 1, amount: 15000, gst: 28 },
        { desc: "Headlight Assembly", type: "Glass", qty: 1, amount: 12000, gst: 28 },
        { desc: "Radiator Grill", type: "Metallic", qty: 1, amount: 8000, gst: 28 }
      ];
      
      const tbody = document.getElementById("partsTableBody");
      parts.forEach((part, index) => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${index + 1}</td>
          <td><input type="text" value="${part.desc}" class="part-desc w-full"></td>
          <td>
            <select class="part-type w-full" onchange="calculatePartRow(this)">
              <option value="metallic" ${part.type === "Metallic" ? "selected" : ""}>Metallic</option>
              <option value="plastic" ${part.type === "Plastic" ? "selected" : ""}>Plastic/Rubber/Nylon</option>
              <option value="glass" ${part.type === "Glass" ? "selected" : ""}>Glass/Fibre</option>
              <option value="battery">Battery</option>
              <option value="tyre">Tyre/Tube</option>
            </select>
          </td>
          <td><input type="number" value="${part.qty}" class="part-qty w-full" onchange="calculatePartRow(this)"></td>
          <td><input type="number" value="${part.amount}" class="part-amount w-full" onchange="calculatePartRow(this)"></td>
          <td>
            <select class="part-gst w-full" onchange="calculatePartRow(this)">
              <option value="0">0%</option>
              <option value="5">5%</option>
              <option value="12">12%</option>
              <option value="18">18%</option>
              <option value="28" selected>28%</option>
            </select>
          </td>
          <td class="part-dep-rate">0%</td>
          <td class="part-dep-amt">0.00</td>
          <td class="part-after-dep">0.00</td>
          <td class="part-gst-amt">0.00</td>
          <td class="part-total">0.00</td>
          <td class="no-print"><button onclick="deleteRow(this)" class="bg-red-500 text-white px-2 py-1 rounded">Delete</button></td>
        `;
        tbody.appendChild(row);
        calculatePartRow(row.querySelector(".part-amount"));
      });
    }

    // Add initial labour rows
    function addInitialLabour() {
      const labour = [
        { desc: "Front body repair", est: 5000, rr: 4000, paint: 1000 },
        { desc: "Bumper replacement", est: 2000, rr: 1500, paint: 500 }
      ];
      
      const tbody = document.getElementById("labourTableBody");
      labour.forEach((item, index) => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${index + 1}</td>
          <td><input type="text" value="${item.desc}" class="labour-desc w-full"></td>
          <td><input type="number" value="${item.est}" class="labour-est w-full" onchange="calculateLabourRow(this)"></td>
          <td><input type="number" value="${item.rr}" class="labour-rr w-full" onchange="calculateLabourRow(this)"></td>
          <td><input type="number" value="${item.paint}" class="labour-paint w-full" onchange="calculateLabourRow(this)"></td>
          <td>
            <select class="labour-gst w-full" onchange="calculateLabourRow(this)">
              <option value="0">0%</option>
              <option value="18" selected>18%</option>
            </select>
          </td>
          <td class="labour-gst-amt">0.00</td>
          <td class="labour-total">0.00</td>
          <td class="no-print"><button onclick="deleteRow(this)" class="bg-red-500 text-white px-2 py-1 rounded">Delete</button></td>
        `;
        tbody.appendChild(row);
        calculateLabourRow(row.querySelector(".labour-est"));
      });
    }

    // Add parts row
    document.getElementById("addPartsRow").addEventListener("click", function() {
      const tbody = document.getElementById("partsTableBody");
      const rowCount = tbody.rows.length + 1;
      const newRow = document.createElement("tr");
      newRow.innerHTML = `
        <td>${rowCount}</td>
        <td><input type="text" placeholder="Part description" class="part-desc w-full"></td>
        <td>
          <select class="part-type w-full" onchange="calculatePartRow(this)">
            <option value="metallic" selected>Metallic</option>
            <option value="plastic">Plastic/Rubber/Nylon</option>
            <option value="glass">Glass/Fibre</option>
            <option value="battery">Battery</option>
            <option value="tyre">Tyre/Tube</option>
          </select>
        </td>
        <td><input type="number" placeholder="Qty" class="part-qty w-full" onchange="calculatePartRow(this)"></td>
        <td><input type="number" placeholder="Amount" class="part-amount w-full" onchange="calculatePartRow(this)"></td>
        <td>
          <select class="part-gst w-full" onchange="calculatePartRow(this)">
            <option value="0">0%</option>
            <option value="5">5%</option>
            <option value="12">12%</option>
            <option value="18">18%</option>
            <option value="28" selected>28%</option>
          </select>
        </td>
        <td class="part-dep-rate">0%</td>
        <td class="part-dep-amt">0.00</td>
        <td class="part-after-dep">0.00</td>
        <td class="part-gst-amt">0.00</td>
        <td class="part-total">0.00</td>
        <td class="no-print"><button onclick="deleteRow(this)" class="bg-red-500 text-white px-2 py-1 rounded">Delete</button></td>
      `;
      tbody.appendChild(newRow);
    });

    // Add labour row
    document.getElementById("addLabourRow").addEventListener("click", function() {
      const tbody = document.getElementById("labourTableBody");
      const rowCount = tbody.rows.length + 1;
      const newRow = document.createElement("tr");
      newRow.innerHTML = `
        <td>${rowCount}</td>
        <td><input type="text" placeholder="Labour description" class="labour-desc w-full"></td>
        <td><input type="number" placeholder="Est Amount" class="labour-est w-full" onchange="calculateLabourRow(this)"></td>
        <td><input type="number" placeholder="R&R" class="labour-rr w-full" onchange="calculateLabourRow(this)"></td>
        <td><input type="number" placeholder="Painting" class="labour-paint w-full" onchange="calculateLabourRow(this)"></td>
        <td>
          <select class="labour-gst w-full" onchange="calculateLabourRow(this)">
            <option value="0">0%</option>
            <option value="18" selected>18%</option>
          </select>
        </td>
        <td class="labour-gst-amt">0.00</td>
        <td class="labour-total">0.00</td>
        <td class="no-print"><button onclick="deleteRow(this)" class="bg-red-500 text-white px-2 py-1 rounded">Delete</button></td>
      `;
      tbody.appendChild(newRow);
    });

    // Delete row
    function deleteRow(btn) {
      const row = btn.closest("tr");
      row.remove();
      renumberRows();
      if (row.closest("#partsTableBody")) {
        calculateAllParts();
      } else {
        calculateAllLabour();
      }
      calculateSummary();
    }

    // Renumber rows after deletion
    function renumberRows() {
      const partsRows = document.querySelectorAll("#partsTableBody tr");
      partsRows.forEach((row, index) => {
        row.cells[0].textContent = index + 1;
      });
      
      const labourRows = document.querySelectorAll("#labourTableBody tr");
      labourRows.forEach((row, index) => {
        row.cells[0].textContent = index + 1;
      });
    }

    // Calculate depreciation based on IRDA guidelines
    function calculateDepreciation(partType, vehicleAge) {
      vehicleAge = parseInt(vehicleAge) || 0;
      
      if (partType === "plastic" || partType === "rubber" || partType === "nylon") {
        return 50; // 50% for plastic/rubber/nylon parts
      } else if (partType === "glass" || partType === "fibre") {
        return 30; // 30% for glass/fibre parts
      } else if (partType === "battery" || partType === "tyre") {
        return 50; // 50% for batteries/tyres/tubes
      } else {
        // Metallic parts - based on vehicle age
        if (vehicleAge <= 0.5) return 0;
        if (vehicleAge <= 1) return 5;
        if (vehicleAge <= 2) return 10;
        if (vehicleAge <= 3) return 15;
        if (vehicleAge <= 4) return 25;
        if (vehicleAge <= 5) return 40;
        if (vehicleAge <= 6) return 45;
        if (vehicleAge <= 7) return 50;
        if (vehicleAge <= 8) return 55;
        return 60; // 60% for vehicles older than 8 years
      }
    }

    // Calculate single part row
    function calculatePartRow(input) {
      const row = input.closest("tr");
      const qty = parseFloat(row.querySelector(".part-qty").value) || 0;
      const amount = parseFloat(row.querySelector(".part-amount").value) || 0;
      const gst = parseFloat(row.querySelector(".part-gst").value) || 0;
      const partType = row.querySelector(".part-type").value || "metallic";
      const vehicleAge = parseInt(document.getElementById("vehicleAge").value) || 0;
      const policyType = document.getElementById("policyType").value;
      
      const rowAmount = qty * amount;
      let depRate = 0;
      let depAmt = 0;
      
      if (policyType === "With depreciation") {
        depRate = calculateDepreciation(partType, vehicleAge);
        depAmt = rowAmount * (depRate / 100);
      }
      
      const afterDep = rowAmount - depAmt;
      const gstAmt = afterDep * (gst / 100);
      const total = afterDep + gstAmt;
      
      row.querySelector(".part-dep-rate").textContent = depRate + "%";
      row.querySelector(".part-dep-amt").textContent = depAmt.toFixed(2);
      row.querySelector(".part-after-dep").textContent = afterDep.toFixed(2);
      row.querySelector(".part-gst-amt").textContent = gstAmt.toFixed(2);
      row.querySelector(".part-total").textContent = total.toFixed(2);
      
      if (depRate > 0) {
        row.classList.add("depreciation-applied");
      } else {
        row.classList.remove("depreciation-applied");
      }
      
      calculateAllParts();
    }

    // Calculate all parts rows
    function calculateAllParts() {
      const rows = document.querySelectorAll("#partsTableBody tr");
      let subtotal = 0;
      let depTotal = 0;
      let afterDepTotal = 0;
      let gstTotal = 0;
      let grandTotal = 0;
      
      rows.forEach(row => {
        subtotal += parseFloat(row.querySelector(".part-amount").value || 0) * parseFloat(row.querySelector(".part-qty").value || 0);
        depTotal += parseFloat(row.querySelector(".part-dep-amt").textContent || 0);
        afterDepTotal += parseFloat(row.querySelector(".part-after-dep").textContent || 0);
        gstTotal += parseFloat(row.querySelector(".part-gst-amt").textContent || 0);
        grandTotal += parseFloat(row.querySelector(".part-total").textContent || 0);
      });
      
      document.getElementById("partsSubtotal").textContent = subtotal.toFixed(2);
      document.getElementById("partsDepTotal").textContent = depTotal.toFixed(2);
      document.getElementById("partsAfterDep").textContent = afterDepTotal.toFixed(2);
      document.getElementById("partsGstTotal").textContent = gstTotal.toFixed(2);
      document.getElementById("partsGrandTotal").textContent = grandTotal.toFixed(2);
      
      // Update summary
      calculateSummary();
    }

    // Calculate single labour row
    function calculateLabourRow(input) {
      const row = input.closest("tr");
      const est = parseFloat(row.querySelector(".labour-est").value) || 0;
      const rr = parseFloat(row.querySelector(".labour-rr").value) || 0;
      const paint = parseFloat(row.querySelector(".labour-paint").value) || 0;
      const gst = parseFloat(row.querySelector(".labour-gst").value) || 0;
      
      const gstAmt = (rr + paint) * (gst / 100);
      const total = rr + paint + gstAmt;
      
      row.querySelector(".labour-gst-amt").textContent = gstAmt.toFixed(2);
      row.querySelector(".labour-total").textContent = total.toFixed(2);
      
      calculateAllLabour();
    }

    // Calculate all labour rows
    function calculateAllLabour() {
      const rows = document.querySelectorAll("#labourTableBody tr");
      let estTotal = 0;
      let rrTotal = 0;
      let paintTotal = 0;
      let gstTotal = 0;
      let grandTotal = 0;
      
      rows.forEach(row => {
        estTotal += parseFloat(row.querySelector(".labour-est").value || 0);
        rrTotal += parseFloat(row.querySelector(".labour-rr").value || 0);
        paintTotal += parseFloat(row.querySelector(".labour-paint").value || 0);
        gstTotal += parseFloat(row.querySelector(".labour-gst-amt").textContent || 0);
        grandTotal += parseFloat(row.querySelector(".labour-total").textContent || 0);
      });
      
      // Calculate painting depreciation (12.5%)
      const paintDep = paintTotal * 0.125;
      const labourAfterDep = grandTotal - paintDep;
      
      document.getElementById("labourEstTotal").textContent = estTotal.toFixed(2);
      document.getElementById("labourRrTotal").textContent = rrTotal.toFixed(2);
      document.getElementById("labourPaintTotal").textContent = paintTotal.toFixed(2);
      document.getElementById("labourGstTotal").textContent = gstTotal.toFixed(2);
      document.getElementById("labourGrandTotal").textContent = grandTotal.toFixed(2);
      document.getElementById("paintDepAmt").textContent = paintDep.toFixed(2);
      document.getElementById("labourAfterDep").textContent = labourAfterDep.toFixed(2);
      
      // Update summary
      calculateSummary();
    }

    // Calculate summary section
    function calculateSummary() {
      const partsBeforeDep = parseFloat(document.getElementById("partsSubtotal").textContent) || 0;
      const partsDep = parseFloat(document.getElementById("partsDepTotal").textContent) || 0;
      const partsAfterDep = parseFloat(document.getElementById("partsAfterDep").textContent) || 0;
      const partsGst = parseFloat(document.getElementById("partsGstTotal").textContent) || 0;
      
      const labourRr = parseFloat(document.getElementById("labourRrTotal").textContent) || 0;
      const labourPaint = parseFloat(document.getElementById("labourPaintTotal").textContent) || 0;
      const paintDep = parseFloat(document.getElementById("paintDepAmt").textContent) || 0;
      const labourGst = parseFloat(document.getElementById("labourGstTotal").textContent) || 0;
      
      const policyExcess = parseFloat(document.getElementById("policyExcess").value) || 0;
      const salvageValue = parseFloat(document.getElementById("salvageValue").value) || 0;
      
      const grossAmount = partsAfterDep + partsGst + labourRr + (labourPaint - paintDep) + labourGst;
      const netAmount = grossAmount - policyExcess - salvageValue;
      const roundedAmount = Math.round(netAmount);
      
      document.getElementById("partsEstimate").value = partsBeforeDep.toFixed(2);
      document.getElementById("depreciationEstimate").value = partsDep.toFixed(2);
      document.getElementById("partsAfterDepEstimate").value = partsAfterDep.toFixed(2);
      document.getElementById("gstPartsEstimate").value = partsGst.toFixed(2);
      document.getElementById("labourRrEstimate").value = labourRr.toFixed(2);
      document.getElementById("labourPaintEstimate").value = labourPaint.toFixed(2);
      document.getElementById("paintDepEstimate").value = paintDep.toFixed(2);
      document.getElementById("labourGstEstimate").value = labourGst.toFixed(2);
      
      document.getElementById("partsAssessed").textContent = partsBeforeDep.toFixed(2);
      document.getElementById("depreciationAssessed").textContent = partsDep.toFixed(2);
      document.getElementById("partsAfterDepAssessed").textContent = partsAfterDep.toFixed(2);
      document.getElementById("gstPartsAssessed").textContent = partsGst.toFixed(2);
      document.getElementById("labourRrAssessed").textContent = labourRr.toFixed(2);
      document.getElementById("labourPaintAssessed").textContent = labourPaint.toFixed(2);
      document.getElementById("paintDepAssessed").textContent = paintDep.toFixed(2);
      document.getElementById("labourGstAssessed").textContent = labourGst.toFixed(2);
      document.getElementById("grossEstimate").textContent = grossAmount.toFixed(2);
      document.getElementById("grossAssessed").textContent = grossAmount.toFixed(2);
      document.getElementById("excessAssessed").textContent = policyExcess.toFixed(2);
      document.getElementById("salvageAssessed").textContent = salvageValue.toFixed(2);
      document.getElementById("netEstimate").textContent = netAmount.toFixed(2);
      document.getElementById("netAssessed").textContent = netAmount.toFixed(2);
      document.getElementById("roundEstimate").textContent = roundedAmount.toFixed(2);
      document.getElementById("roundAssessed").textContent = roundedAmount.toFixed(2);
      
      // Update amount in words
      document.getElementById("amountInWords").textContent = numberToWords(roundedAmount);
    }

    // Calculate fees section
    function calculateFees() {
      const surveyFee = parseFloat(document.getElementById("surveyFee").value) || 0;
      const conveyance = parseFloat(document.getElementById("conveyance").value) || 0;
      const photoExpense = parseFloat(document.getElementById("photoExpense").value) || 0;
      
      const total = surveyFee + conveyance + photoExpense;
      const taxableValue = total / 1.18;
      const cgst = taxableValue * 0.09;
      const sgst = taxableValue * 0.09;
      const grandTotal = total;
      
      document.getElementById("feesTotal").textContent = total.toFixed(2);
      document.getElementById("taxableValue").textContent = taxableValue.toFixed(2);
      document.getElementById("cgstAmount").textContent = cgst.toFixed(2);
      document.getElementById("sgstAmount").textContent = sgst.toFixed(2);
      document.getElementById("totalGst").textContent = (cgst + sgst).toFixed(2);
      document.getElementById("grandTotal").textContent = grandTotal.toFixed(2);
      document.getElementById("roundTotal").textContent = Math.round(grandTotal).toFixed(2);
    }

    // Convert number to words
    function numberToWords(num) {
      const ones = ['', 'one', 'two', 'three', 'four', 'five', 'six', 'seven', 'eight', 'nine'];
      const tens = ['', 'ten', 'twenty', 'thirty', 'forty', 'fifty', 'sixty', 'seventy', 'eighty', 'ninety'];
      const teens = ['ten', 'eleven', 'twelve', 'thirteen', 'fourteen', 'fifteen', 'sixteen', 'seventeen', 'eighteen', 'nineteen'];
      
      if (num === 0) return '(Rupees zero only)';
      
      let words = '(Rupees ';
      
      // Crores
      if (num >= 10000000) {
        const crore = Math.floor(num / 10000000);
        words += numberToWords(crore) + ' crore ';
        num %= 10000000;
      }
      
      // Lakhs
      if (num >= 100000) {
        const lakh = Math.floor(num / 100000);
        words += numberToWords(lakh) + ' lakh ';
        num %= 100000;
      }
      
      // Thousands
      if (num >= 1000) {
        const thousand = Math.floor(num / 1000);
        words += numberToWords(thousand) + ' thousand ';
        num %= 1000;
      }
      
      // Hundreds
      if (num >= 100) {
        const hundred = Math.floor(num / 100);
        words += ones[hundred] + ' hundred ';
        num %= 100;
      }
      
      // Tens and ones
      if (num > 0) {
        if (words !== '(Rupees ') {
          words += 'and ';
        }
        
        if (num < 10) {
          words += ones[num];
        } else if (num < 20) {
          words += teens[num - 10];
        } else {
          words += tens[Math.floor(num / 10)];
          if (num % 10 > 0) {
            words += ' ' + ones[num % 10];
          }
        }
      }
      
      return words + ' only)';
    }

    // Export to Word document
    function exportToWord() {
      const element = document.querySelector('.max-w-7xl');
      const opt = {
        margin: 1,
        filename: 'Motor_Survey_Report.doc', // Changed to .doc extension
        image: { type: 'jpeg', quality: 0.98 },
        html2canvas: { scale: 2 },
        jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' }
      };

      // New Promise-based usage:
      html2docx(element, opt)
        .then(() => {
          console.log('Document generated successfully');
        })
        .catch(err => {
          console.error('Error generating document:', err);
        });
    }

    // Save report (placeholder)
    function saveReport() {
      alert("Report saved successfully! (This would connect to a backend in a real application)");
    }

    // Reset form
    function resetForm() {
      if (confirm("Are you sure you want to reset the entire form?")) {
        document.getElementById("partsTableBody").innerHTML = '';
        document.getElementById("labourTableBody").innerHTML = '';
        document.getElementById("refGenerator").classList.remove("hidden");
        addInitialParts();
        addInitialLabour();
        calculateAllParts();
        calculateAllLabour();
        calculateSummary();
      }
    }
  </script></div>
<!-- Working Word Export Button -->
<button class="download-btn" id="downloadDocxBtn">Download Report as Word</button>
<!-- Required Libraries -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/html-docx-js@0.4.0/dist/html-docx.min.js"></script>
<!-- Button Styling -->
<style>
  .download-btn {
    background-color: #0078D7;
    color: white;
    font-size: 16px;
    padding: 10px 20px;
    margin: 30px 0;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
  }
  .download-btn:hover {
    background-color: #005FA3;
  }
</style>
<!-- JS to Export to Word -->
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const btn = document.getElementById("downloadDocxBtn");
    if (btn) {
      btn.addEventListener("click", function () {
        const content = document.getElementById("report").innerHTML;
        const preHtml = "<html><head><meta charset='utf-8'><title>Report</title></head><body>";
        const postHtml = "</body></html>";
        const html = preHtml + content + postHtml;
        const converted = htmlDocx.asBlob(html, { orientation: 'portrait' });
        saveAs(converted, "Motor_Survey_Report.docx");
      });
    }
  });
</script>
</body></html>